<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ActivityX</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="styles/layout.css">
    <link rel="stylesheet" href="styles/pages/reports.css">
    <link rel="stylesheet" href="styles/pages/dashboard.css">
    <link rel="stylesheet" href="styles/pages/calisanlar.css">
    <link rel="stylesheet" href="styles/pages/ekipler.css">
    <link rel="stylesheet" href="styles/pages/profile.css">
    <link rel="stylesheet" href="styles/pages/table-responsive.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <div class="app-layout">
        <!-- Sidebar -->
        <aside class="sidebar collapsed">
            <!-- Logo Section -->
            <div class="sidebar-logo-section">
                <span class="sidebar-logo-text">ActivityX</span>
            </div>

            <!-- Navigation -->
            <nav class="sidebar-nav">
                <a href="#dashboard" class="nav-item active" data-route="dashboard">
                    <svg class="nav-item-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="7"></rect>
                        <rect x="14" y="3" width="7" height="7"></rect>
                        <rect x="14" y="14" width="7" height="7"></rect>
                        <rect x="3" y="14" width="7" height="7"></rect>
                    </svg>
                    <span class="nav-item-text">Ana Sayfa</span>
                </a>
                <a href="#table" class="nav-item" data-route="table">
                    <svg class="nav-item-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="3" y1="9" x2="21" y2="9"></line>
                        <line x1="3" y1="15" x2="21" y2="15"></line>
                        <line x1="9" y1="9" x2="9" y2="21"></line>
                        <line x1="15" y1="9" x2="15" y2="21"></line>
                    </svg>
                    <span class="nav-item-text">Aktivite Tablosu</span>
                </a>
                <a href="#calisanlar" class="nav-item" data-route="calisanlar">
                    <svg class="nav-item-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect>
                        <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>
                    </svg>
                    <span class="nav-item-text">Çalışanlar</span>
                </a>
                <a href="#ekipler" class="nav-item" data-route="ekipler">
                    <svg class="nav-item-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                    </svg>
                    <span class="nav-item-text">Ekipler</span>
                </a>
                <a href="#reports" class="nav-item" data-route="reports">
                    <svg class="nav-item-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="20" x2="18" y2="10"></line>
                        <line x1="12" y1="20" x2="12" y2="4"></line>
                        <line x1="6" y1="20" x2="6" y2="14"></line>
                    </svg>
                    <span class="nav-item-text">Raporlar</span>
                </a>
            </nav>

            <!-- Sidebar Footer -->
            <div class="sidebar-footer">
                <!-- User Profile -->
                <div class="sidebar-user-profile" id="profile-btn">
                    <div class="sidebar-user-avatar">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <circle cx="12" cy="10" r="3"></circle>
                            <path d="M6.168 18.849A4 4 0 0 1 10 16h4a4 4 0 0 1 3.834 2.855"></path>
                        </svg>
                    </div>
                    <div class="sidebar-user-info">
                        <div class="sidebar-user-name" id="sidebar-user-name">Kullanıcı</div>
                        <div class="sidebar-user-role" id="sidebar-user-role">Yönetici</div>
                    </div>
                </div>

                <!-- Logout Button -->
                <button class="sidebar-footer-btn" id="sidebar-logout-btn">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                        <polyline points="16 17 21 12 16 7"></polyline>
                        <line x1="21" y1="12" x2="9" y2="12"></line>
                    </svg>
                    <span class="sidebar-footer-text">Çıkış Yap</span>
                </button>
            </div>
        </aside>

        <!-- Main Layout -->
        <div class="main-layout">
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="header-left">
                    <h2 class="page-title" id="page-title">Ana Sayfa</h2>
                </div>
                <div class="header-right">
                    <h1 class="app-title">
                        <img src="transparentlogo.png" alt="Logo" class="app-logo">
                    </h1>
                </div>
            </div>
        </header>

        <!-- Main Content - Dynamic Page Container -->
        <main class="page-content" id="page-content">
            <!-- Pages will be loaded here dynamically -->
        </main>

        <!-- Logout Confirmation Modal -->
        <div class="modal" id="logout-modal">
            <div class="modal-content logout-modal-content">
                <div class="modal-header">
                    <h3>Çıkış Yap</h3>
                </div>
                <div class="modal-body">
                    <p>Oturumu kapatmak istediğinize emin misiniz?</p>
                    <div class="modal-actions">
                        <button class="btn btn-secondary" id="logout-cancel">İptal Et</button>
                        <button class="btn btn-primary" id="logout-confirm">Çıkış Yap</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Refresh Data Confirmation Modal -->
        <div class="modal" id="refresh-modal">
            <div class="modal-content logout-modal-content">
                <div class="modal-header">
                    <h3>Verileri Güncelle</h3>
                </div>
                <div class="modal-body">
                    <p>Veritabanından güncel verileri çekmek istediğinize emin misiniz?</p>
                    <div class="modal-actions">
                        <button class="btn btn-secondary" id="refresh-cancel">İptal Et</button>
                        <button class="btn btn-primary" id="refresh-confirm">Güncelle</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Edit Username Modal -->
        <div class="modal" id="edit-username-modal">
            <div class="modal-content edit-username-modal-content">
                <div class="modal-header">
                    <h3>Kullanıcı Adını Düzenle</h3>
                    <button class="modal-close" onclick="closeEditUsernameModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <p class="edit-modal-info">
                        <strong>Orijinal PC Adı:</strong> <span id="edit-modal-pc-name"></span>
                    </p>
                    <form id="edit-username-form" onsubmit="saveUsername(event)">
                        <div class="form-group">
                            <label for="custom-username-input">Özel Görünen Ad:</label>
                            <input
                                type="text"
                                id="custom-username-input"
                                placeholder="Örn: Ahmet Yılmaz"
                                required
                                maxlength="50"
                            >
                        </div>
                        <div class="modal-actions">
                            <button type="button" class="btn btn-secondary" onclick="closeEditUsernameModal()">İptal</button>
                            <button type="submit" class="btn btn-primary">Kaydet</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- User Detail Modal -->
        <div class="modal" id="user-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modal-user-name">Kullanıcı Detayları</h3>
                    <div class="modal-header-buttons">
                        <button class="btn btn-secondary" id="modal-export-btn">CSV İndir</button>
                        <button class="modal-close">&times;</button>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="modal-stats">
                        <div class="modal-stat">
                            <label>Aktif Süre:</label>
                            <span id="modal-active-time"></span>
                        </div>
                        <div class="modal-stat">
                            <label>Tarih Aralığı:</label>
                            <span id="modal-date-range"></span>
                        </div>
                        <div class="modal-stat">
                            <label>Gün Sayısı:</label>
                            <span id="modal-day-count"></span>
                        </div>
                        <div class="modal-stat">
                            <label>Ortalama Günlük Aktif Süre:</label>
                            <span id="modal-daily-average"></span>
                        </div>
                    </div>

                    <!-- Activity Timeline (Only visible when day count = 1) -->
                    <div class="modal-timeline-section" id="modal-timeline-section" style="display: none;">
                        <h4>Günlük Aktivite Zaman Çizelgesi</h4>
                        <div class="timeline-container">
                            <div class="timeline-canvas-wrapper">
                                <canvas id="timeline-canvas" width="1000" height="60"></canvas>
                                <div class="timeline-hour-labels">
                                    <span>00:00</span>
                                    <span>03:00</span>
                                    <span>06:00</span>
                                    <span>09:00</span>
                                    <span>12:00</span>
                                    <span>15:00</span>
                                    <span>18:00</span>
                                    <span>21:00</span>
                                    <span>24:00</span>
                                </div>
                            </div>
                            <div class="timeline-legend">
                                <span class="legend-item">
                                    <span class="legend-color" style="background: #4A7B93;"></span>
                                    Aktif
                                </span>
                                <span class="legend-item">
                                    <span class="legend-color" style="background: #f8f9fa; border: 1px solid #999;"></span>
                                    İnaktif
                                </span>
                            </div>
                        </div>
                        <!-- Hover Tooltip -->
                        <div id="timeline-tooltip" class="timeline-tooltip" style="display: none;">
                            <strong id="tooltip-time-range">00:00 - 00:00</strong>
                            <div id="tooltip-state">Durum: -</div>
                            <div id="tooltip-duration">Süre: -</div>
                        </div>
                    </div>

                    <!-- Detailed Tables -->
                    <div class="modal-tables">
                        <div class="modal-table-container">
                            <h4>Detaylı Uygulama Kullanımı</h4>
                            <input type="text" id="modal-apps-search" class="modal-search-input" placeholder="Uygulama ara...">
                            <div class="table-scroll">
                                <table class="modal-table">
                                    <thead>
                                        <tr>
                                            <th>Uygulama Adı</th>
                                            <th>Süre</th>
                                            <th>Yüzde</th>
                                        </tr>
                                    </thead>
                                    <tbody id="modal-apps-table"></tbody>
                                </table>
                            </div>
                        </div>
                        
                        <div class="modal-table-container">
                            <h4>Detaylı Web Sitesi Kullanımı</h4>
                            <input type="text" id="modal-websites-search" class="modal-search-input" placeholder="Web sitesi ara...">
                            <div class="table-scroll">
                                <table class="modal-table">
                                    <thead>
                                        <tr>
                                            <th>Web Sitesi</th>
                                            <th>Süre</th>
                                            <th>Yüzde</th>
                                        </tr>
                                    </thead>
                                    <tbody id="modal-websites-table"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="modal-charts">
                        <div class="modal-chart-container">
                            <h4>Uygulama Kullanım Dağılımı</h4>
                            <canvas id="modal-apps-chart"></canvas>
                        </div>
                        <div class="modal-chart-container">
                            <h4>Web Sitesi Kullanım Dağılımı</h4>
                            <canvas id="modal-websites-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
        </div>
    </div>

    <script src="js/browser-supabase.js"></script>
    <script src="js/userNameMapping.js"></script>
    <script src="js/sidebar.js"></script>
    <script src="js/router.js"></script>
    <script src="js/pages/profile.js"></script>
    <script src="app.js"></script>
    <script src="js/pages/reports.js"></script>
    <script src="js/pages/reports-calendar.js"></script>
    <script src="js/logout-modal.js"></script>
    <!-- Debug tool for localStorage issues -->
    <script src="debug-localstorage.js"></script>
</body>
</html> 